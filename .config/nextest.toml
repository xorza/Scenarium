# cargo-nextest configuration
# https://nexte.st/book/configuration.html

[profile.default]
# Run tests with moderate parallelism
test-threads = "num-cpus"

# Retry failed tests once
retries = 0

# Fail fast on first failure
fail-fast = true

# Status level - show pass/fail/skip
status-level = "pass"

# Final status level
final-status-level = "fail"

# Slow test threshold (warn after this duration)
slow-timeout = { period = "30s", terminate-after = 2 }

[profile.ci]
# CI profile with more conservative settings
test-threads = "num-cpus"
retries = 0
fail-fast = false
slow-timeout = { period = "30s", terminate-after = 2 }

# GPU tests need single-threaded execution to share GPU context
[[profile.default.overrides]]
filter = "package(imaginarium) & test(/gpu/)"
threads-required = 1

[[profile.ci.overrides]]
filter = "package(imaginarium) & test(/gpu/)"
threads-required = 1
